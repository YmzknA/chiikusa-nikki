<%= turbo_frame_tag "weekday-pattern-chart" do %>
  <div class="neuro-card p-6">
    <div class="flex items-center justify-between mb-6">
      <h2 class="flex items-center gap-2 text-xl font-bold text-primary">
        <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
        æ›œæ—¥åˆ¥ãƒ‘ã‚¿ãƒ¼ãƒ³
      </h2>
      
      <div data-controller="chart-period"
           data-chart-period-chart-type-value="weekday-pattern">
        <div class="flex items-center gap-2">
          <%= select_tag :weekday_months,
              options_for_select([
                ['ç›´è¿‘1ãƒ¶æœˆ', 1],
                ['éå»2ãƒ¶æœˆ', 2],
                ['éå»3ãƒ¶æœˆ', 3],
                ['éå»6ãƒ¶æœˆ', 6],
                ['éå»1å¹´', 12]
              ], params[:weekday_months]&.to_i || 1),
              { 
                class: "neuro-input px-3 py-2 text-sm",
                data: { action: "change->chart-period#updateChart" }
              } %>
        </div>
      </div>
    </div>
    
    <div class="neuro-input p-4 w-full">
      <div data-controller="weekday-chart" 
           data-weekday-chart-type-value="<%= (local_assigns[:weekday_pattern_chart] || @weekday_pattern_chart)[:type] %>"
           data-weekday-chart-data-value="<%= (local_assigns[:weekday_pattern_chart] || @weekday_pattern_chart)[:data].to_json %>"
           data-weekday-chart-options-value="<%= (local_assigns[:weekday_pattern_chart] || @weekday_pattern_chart)[:options].to_json %>">
        <canvas class="w-full" style="height: 300px;"></canvas>
      </div>
    </div>
    
    <div class="mt-4">
      <div class="neuro-badge p-3 text-sm text-base-content/70">
        ğŸ“… <strong>å¯¾è±¡æœŸé–“:</strong> é¸æŠã—ãŸæœŸé–“<br>
        æ›œæ—¥ã”ã¨ã®å¹³å‡ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã§ç”Ÿæ´»ãƒªã‚ºãƒ ã‚’æŠŠæ¡
      </div>
    </div>
  </div>
<% end %>