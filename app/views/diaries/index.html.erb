<h1>日記カレンダー</h1>

<%= link_to "新しい日記を書く", new_diary_path %>

<%= month_calendar(events: @diaries, attribute: :date) do |date, diaries| %>
  <%= date.day %>

  <% if diaries.any? %>
    <% diary = diaries.first %>
    <% mood_level = diary.diary_answers.find_by(question: Question.find_by(identifier: :mood))&.answer&.level || 3 %>
    <%= link_to diary_path(diary) do %>
      <div class="w-full h-full flex items-center justify-center">
        <%= render "diaries/weed", mood_level: mood_level %>
      </div>
    <% end %>
  <% else %>
    <%= link_to "+", new_diary_path(date: date), class: "w-full h-full flex items-center justify-center text-gray-400 hover:text-gray-600" %>
  <% end %>
<% end %>